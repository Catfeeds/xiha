<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<!--[if lt IE 9]>
<script type="text/javascript" src="__PUBLIC__/Admin/assets/lib/html5.js"></script>
<script type="text/javascript" src="__PUBLIC__/Admin/assets/lib/respond.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/Admin/assets/lib/PIE_IE678.js"></script>
<![endif]-->
<!-- <link href="__PUBLIC__/Admin/assets/css/H-ui.min.css" rel="stylesheet" type="text/css" /> -->
<!-- <link href="__PUBLIC__/Admin/assets/css/style.css" rel="stylesheet" type="text/css" /> -->
<!-- <link href="__PUBLIC__/Admin/assets/css/H-ui.admin.css" rel="stylesheet" type="text/css" /> -->
<!-- <link href="__PUBLIC__/Admin/assets/lib/Hui-iconfont/1.0.6/iconfont.css" rel="stylesheet" type="text/css" /> -->
<link href="__PUBLIC__/Admin/assets/css/admin.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/assets/css/select2.css">
<link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/assets/css/select2-bootstrap.css">
<link href="__PUBLIC__/Admin/assets/css/pintuer.css" rel="stylesheet" type="text/css" />

<!--[if IE 6]>
<script type="text/javascript" src="lib/DD_belatedPNG_0.0.8a-min.js" ></script>
<script>DD_belatedPNG.fix('*');</script>
<![endif]-->
<title>修改教练信息</title>
</head>
<body>
   <div class="tab-body">
    <br />
    <div class="tab-panel active" id="tab-set">
        <form method="post" class="form-x" style="width:80%" action="{: U('Coach/editCoach')}" enctype="multipart/form-data" id="addCoachForm" >
            <input type="hidden" id="l_coach_id" name="l_coach_id" value="{$coachlist.l_coach_id}"  />
            
            <div class="form-group">
                <div class="label"><label for="coach_name"><span style="color:red">*</span>姓名</label></div>
                <div class="field" style="width:360px;">
                     <input type="text" class="input" id="coach_name" name="coach_name" value="{$coachlist.s_coach_name}" size="20" placeholder="请填写姓名" data-validate="required:请填写姓名" />
                </div>
            </div>

            <div class="form-group">
                <div class="label"><label for="coach_phone"><span style="color:red">*</span>手机号码</label></div>
                <div class="field" style="width:360px;">
                     <input type="text" class="input" id="coach_phone" value="{$coachlist.s_coach_phone}" name="coach_phone" size="20" placeholder="请填写手机号码" data-validate="required:请填写手机号码" />
                </div>
            </div>
            <div class="form-group">
                <div class="label"><label for="coach_age">教龄</label></div>
                <div class="field" style="width:360px;">
                     <input type="text" class="input" id="coach_age" value="{$coachlist.s_teach_age}" name="coach_age" size="20" placeholder="请填写教龄" data-validate="required:请填写教龄" />
                </div>
            </div>
            <div class="form-group">
                <div class="label"><label for="coach_star">教练平均星级</label></div>
                <div class="field" style="width:360px;">
                    <input type="text" class="input" value="{$coachlist.i_coach_star}" id="coach_star" name="coach_star"  placeholder="请填写教练平均星级，如：3" />
                </div>
            </div>
            <div class="form-group">
                <div class="label"><label for="average_license_time">平均拿证时间</label></div>
                <div class="field" style="width:340px;">
                     <input type="text" class="input" value="{$coachlist.average_license_time}" id="average_license_time" name="average_license_time" size="20" placeholder="请填写平均拿证时间，如：4"  />
                </div>
                <div class="label" style="margin-left:-12%"><label for="time">天</label></div>
            </div>
            
            <div class="form-group">
                <div class="label"><label for="lesson2_pass_rate">科目二通过率</label></div>
                <div class="field" style="width:340px;">
                     <input type="text" class="input" value="{$coachlist.lesson2_pass_rate}" id="lesson2_pass_rate" name="lesson2_pass_rate" size="20" placeholder="请填写科目二通过率，如：100"  />
                </div>
                <div class="label" style="margin-left:-12%"><label for="rate">%</label></div>
            </div>
            <div class="form-group">
                <div class="label"><label for="lesson3_pass_rate">科目三通过率</label></div>
                <div class="field" style="width:340px;">
                     <input type="text" class="input" value="{$coachlist.lesson3_pass_rate}" id="lesson3_pass_rate" name="lesson3_pass_rate" size="20" placeholder="请填写科目三通过率，如：100"  />
                </div>
                <div class="label" style="margin-left:-12%"><label for="rate">%</label></div>
            </div>
            <div class="form-group">
                <div class="label"><label>教练性别</label></div>
                <div class="field">
                    <div class="button-group button-group-small radio">
                      <if condition="$coachlist.s_coach_sex eq 1">
                        <label class="button active">
                          <input name="coach_sex" value="1"  type="radio"  ckecked="checked">
                          <span class="icon icon-check text-green"></span> 男
                        </label>
                        <label class="button">
                          <input name="coach_sex" value="0" type="radio" >
                          <span class="icon icon-check text-red"></span> 女
                        </label>
                      <else/>
                        <label class="button">
                          <input name="coach_sex" value="1"  type="radio">
                          <span class="icon icon-check text-green"></span> 男
                        </label>
                        <label class="button active">
                          <input name="coach_sex" value="0" type="radio"  ckecked="checked">
                          <span class="icon icon-check text-red"></span> 女
                        </label>
                      </if>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="label"><label for="license_img">头像</label></div>
                <div class="field">
                    <div class="imgdiv">
                        <!-- <img src="__PUBLIC__/../{$coachlist.s_coach_imgurl}" id="imgShow" width="128" height="128" class="img-border radius-small" /> -->
                        <img src="{$coachlist.coach_imgurl}" id="imgShow" width="128" height="128" class="img-border radius-small" />
                    </div>

                    <a class="button input-file bg-green" href="javascript:;">+ 浏览文件
                        <input size="100" type="file" name="license_img" value="" id="license_img" data-validate="regexp#.+.(jpg|jpeg|png|gif)$:只能上传jpg|gif|png格式文件" />
                        <!-- <input type="hidden" name="oldimg" value="__PUBLIC__/../{$coachlist.s_coach_imgurl}"> -->
                        <input type="hidden" name="oldimg" value="{$coachlist.coach_imgurl}">
                    </a>
                </div>
            </div>
            
            <if condition = "$school_id eq 0" >
                 <input type="hidden" class="input" id="s_school_id" value="{$coachlist.s_school_name_id}" name="school_id" size="20" />
                <div class="form-group">
                  <div class="label"><label for="school_id"><span style="color:red">*</span>所属驾校</label></div>
                  <div class="field" style="width:360px">
                       <input type="text" class="input" id="school_name" value="{$coachlist.s_school_name}" name="school_name" size="20" readonly/>
                       <input type="hidden" class="input" id="s_school_id" value="{$coachlist.s_school_name_id}" name="school_id" size="20" />
                    <span class="clearfix"></span>
                  </div>
                </div>
            <else/>
                <input type="hidden" class="input" id="s_school_id" value="{$coachlist.s_school_name_id}" name="school_id" size="20" />
                <!-- <div class="form-group">
                    <div class="label"><label for="school_id"><span style="color:red">*</span>所属驾校</label></div>
                    <div class="field" style="width:200px;">
                      <select select2 ng-model="b" id="school_id" class="form-control" name="school_id"  placeholder="请选择驾校" data-validate="required:请选择所属驾校">
                          <foreach name="school_list"  item="value">
                            <option value="{$value.l_school_id}">{$value.s_school_name}</option> 
                          </foreach>
                      </select>
                      <span class="clearfix"></span>
                    </div>
              </div> -->
            </if>
            <if condition = "$school_id neq 0" >
              <div class="form-group">
                  <div class="label"><label for="coach_car"><span style="color:red">*</span>所属车辆</label></div>
                  <div class="field" style="width:360px">
                      <select class="input" id="coach_car" style=" float:left" name="coach_car" data-validate="required:请填写所属车辆"> 
                          <if condition="$coachlist.s_coach_car_id eq ''">
                              <option value="">请选择车辆</option> 
                          <else/>
                              <option value="{$coachlist.s_coach_car_id}">{$coachlist.name} ({$coachlist.car_no})</option> 
                          </if>
                          <if condition="$carlist neq ''">
                            <foreach name="carlist" item="value">
                              <if condition="$value.car_no eq ''">
                                  <option value="{$value.id}">{$value.name}</option>
                              <else/>
                                  <option value="{$value.id}">{$value.name} ({$value.car_no})</option>
                              </if>
                            </foreach>
                          <else/>
                            <option value="">暂无车辆列表</option>
                          </if>
                            
                      </select>
                       <!-- <div style="margin-left:200px;width:100px;"><a href="{:U('Cars/addCar')}" class="button bg-yellow">添加车辆</a></div> -->
                  </div>
              </div>
            <else/>
              <div class="form-group">
                  <div class="label"><label for="coach_car"><span style="color:red">*</span>所属车辆</label></div>
                  <div class="field" style="width:360px">
                      <select class="input" id="coach_car" style=" float:left" name="coach_car" data-validate="required:请填写所属车辆"> 
                            <!-- <option value="">请选择车辆</option>  -->
                            <if condition="$coachlist.s_coach_car_id eq ''">
                                <option value="">请选择车辆</option> 
                            <else/>
                                <option value="{$coachlist.s_coach_car_id}">{$coachlist.name} ({$coachlist.car_no})</option> 
                            </if>
                            <if condition="$carlist neq ''">
                                <foreach name="carlist" item="value">
                                  <if condition="$value.car_no eq ''">
                                      <option value="{$value.id}">{$value.name}</option>
                                  <else/>
                                      <option value="{$value.id}">{$value.name} ({$value.car_no})</option>
                                  </if>
                                </foreach>
                            <else/>
                              <option value="">暂无车辆列表</option>
                            </if>
                      </select>
                       <!-- <div style="margin-left:200px;width:100px;"><a href="{:U('Cars/addCar')}" class="button bg-yellow">添加车辆</a></div> -->
                  </div>
              </div>
            </if>

            <div class="form-group">
                <div class="label"><label for="lessonInfo"><span style="color:red">*</span>培训课程</label></div>
                <div class="field">
                    <div class="button-group border-main checkbox"> 
                        <foreach name="coach_lesson" key="k" item="v">
                            <if condition="$v.is_key eq 1">
                                <label class="button active"><input name="lesson_id[]" value="{$k}" type="checkbox" checked="checked" data-validate="required:请填写培训课程">{$v.coach_lesson_name}</label>
                            <else/>
                                <label class="button"><input name="lesson_id[]" value="{$k}" type="checkbox" data-validate="required:请填写培训课程">{$v.coach_lesson_name}</label>
                            </if>
                        </foreach> 

                    </div>
                    <span class="tips icon-exclamation-circle" style="color:#f60; cursor:pointer;" data-toggle="hover" data-place="right" title="培训课程可多选"></span>
                </div>
            </div>

            <div class="form-group">
                <div class="label"><label for="licenseInfo"><span style="color:red">*</span>培训牌照</label></div>
                <div class="field" >
                    <div class="button-group border-main checkbox">
                        <foreach name="coach_license" key="k" item="v">
                            <if condition="$v.is_key eq 1">
                                <label class="button active" ><input name="license_id[]" value="{$k}" type="checkbox" checked="checked" data-validate="required:请填写培训牌照">{$v.coach_license_name}</label>
                            <else/>
                                <label class="button"><input name="license_id[]" value="{$k}" type="checkbox" data-validate="required:请填写培训牌照">{$v.coach_license_name}</label>
                            </if>
                        </foreach> 
                    </div>
                    <span class="tips icon-exclamation-circle" style="color:#f60; cursor:pointer;" data-toggle="hover" data-place="right" title="培训牌照可多选"></span>
                </div>
            </div>
            
            <div class="form-group">
                <div class="label"><label for="address"><span style="color:red">*</span>地址</label></div>
                <div class="field">
                   <select class="input" id="province" style="width:20%; float:left" name="province" data-validate="required:请选择省">
                      <if condition="$coachlist.province_id neq '' "> 
                        <option value="{$coachlist.province_id}">{$coachlist.province}</option> 
                      <else/>
                        <option value="">请选择省</option> 
                      </if>
                        <foreach name="province_list" item="pro">
                          <option value="{$pro.provinceid}">{$pro.province}</option>
                        </foreach>
                   </select>

                   <select class="input" id="city" style="width:20%; float:left" name="city" data-validate="required:请选择市"> 
                      <if condition="$coachlist.city_id neq ''">
                        <option value="{$coachlist.city_id}">{$coachlist.city}</option>
                      <else/>
                        <option value="">请选择市</option>
                      </if>
                   </select>

                   <select class="input" id="area" style="width:20%; float:left" name="area" data-validate="required:请选择区域"> 
                      <if condition="$coachlist.area_id neq ''">
                        <option value="{$coachlist.area_id}">{$coachlist.area}</option>
                      <else/>
                        <option value="">请选择区域</option> 
                      </if>
                   </select>
                </div>
            </div>

            <div class="form-group">
                <div class="label"><label for="address"><span style="color:red">*</span>详细地址</label></div>
                <div class="field" style="width:360px;">
                  <if condition="$coachlist.s_coach_address neq ''">
                    <input type="text" class="input" id="address" name="address" value="{$coachlist.s_coach_address}" size="50" placeholder="详细地址" data-validate="required:请填写详细地址"/>
                  <else/>
                    <input type="text" class="input" id="address" name="address" value="{$coachlist.province}{$coachlist.city}{$coachlist.area}" size="50" placeholder="详细地址" data-validate="required:请填写详细地址"/>
                  </if>
                </div>
            </div>

            <div class="form-group">
                <div class="label"><label for="coach_type"><span style="color:red">*</span>教练类型</label></div>
                <div class="field" style="width:360px">
                    <select class="input" id="coach_type" style="" name="coach_type" data-validate="required:请选择教练类型"> 
                        <!-- <option value="">请选择教练类型</option>  -->
                        <option value="0" <if condition="$coachlist.i_type eq 0">selected</if> >金牌教练员</option>
                        <option value="1" <if condition="$coachlist.i_type eq 1">selected</if> >普通教练员</option>
                        <option value="2" <if condition="$coachlist.i_type eq 2">selected</if> >二级优秀教练员</option>
                        <option value="5" <if condition="$coachlist.i_type eq 5">selected</if> >二级优秀教练员 全国优秀教练员荣誉</option>
                        <option value="3" <if condition="$coachlist.i_type eq 3">selected</if> >三级优秀教练员</option>
                        <option value="6" <if condition="$coachlist.i_type eq 6">selected</if> >三级优秀教练员 全国优秀教练员荣誉</option>
                        <option value="4" <if condition="$coachlist.i_type eq 4">selected</if> >四级优秀教练员</option>
                    </select> 
                </div>
            </div>

            <div class="form-group">
                <div class="label"><label>是否在线</label></div>
                <div class="field">
                    <div class="button-group button-group-small radio">
                      <if condition="$coachlist.order_receive_status eq 1">
                        <label class="button active">
                        <input name="is_online" value="1"  type="radio"  checked>
                        <span class="icon icon-check text-green"></span> 在线</label>
                        <label class="button">
                        <input name="is_online" value="0" type="radio" <if condition="$coachlist.order_receive_status eq 0"></if> >
                        <span class="icon icon-times"></span> 不在线</label>
                      <else/>
                        <label class="button">
                        <input name="is_online" value="1"  type="radio"  >
                        <span class="icon icon-check text-green"></span> 在线</label>
                        <label class="button active">
                        <input name="is_online" value="0" type="radio" checked>
                        <span class="icon icon-times"></span> 不在线</label>
                      </if>
                    </div>
                </div>
            </div>
            
       
            <if condition = "$school_id eq 0" >
              <div class="form-button"><button class="button bg-main" type="submit" id="submitone">提交</button></div>
            <else/>
              <div class="form-button"><button class="button bg-main" type="submit">提交</button></div>
            </if>
      </form>
    </div>

<script type="text/javascript" src="__PUBLIC__/Admin/assets/lib/jquery/2.1.1/jquery.min.js"></script> 
<script type="text/javascript" src="__PUBLIC__/Admin/assets/js/pintuer.js"></script>
<script type="text/javascript" src="__PUBLIC__/Admin/assets/js/uploadPreview.min.js"></script> 
<!-- <script type="text/javascript" src="__PUBLIC__/Admin/assets/lib/jquery/jquery.provincesCity.js"></script> -->
<script type="text/javascript" src="__PUBLIC__/Admin/assets/layerv2/layer.js"></script> 
<script type="text/javascript" src="__PUBLIC__/Admin/assets/js/bootstrap.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/Admin/assets/js/angular.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/Admin/assets/js/select2.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/Admin/assets/js/selectindex.js"></script>
<script type="text/javascript">
// 通过获得学校id而获得相应的车辆信息
  $(function () {
    $('#school_id').click(function() {
      var school_id   = $('#school_id').val();
      // alert(school_id);return false;
       $.ajax({
            type:"POST",
            url:"__URL__/getCarsByIds",
            data:{'school_id':school_id},
            dataType:'JSON',
            success:function(data) {
                if(data.code == 200) {
                    // console.log(data.data);
                    if (data.data) {
                        var i = 0;
                        var max = data.data.length;
                        html = '' ;
                        if (max > 0) {
                            html +='<option value="" >请选择车辆</option>';
                            for ( ; i < max; i++) {
                                html +='<option value="'+data.data[i]['id']+'" >'+data.data[i]['name']+' '+'('+data.data[i]['car_no']+')'+'</option>';
                            }
                        } else {
                            html +='<option value="" >暂无车辆</option>';
                        }
                        var carscatelist = document.getElementById('coach_car');
                        carscatelist.innerHTML = html;
                    }
                } else {
                    layer.msg(data.msg,{icon:2,time:1000});
                }
            },
            error:function() {
                layer.msg('网络错误，请检查网络!',{icon:2,time:1000});    
            }
        });
    });



  })
 // // 上传图片预览
  window.onload = function () { 
      new uploadPreview({ UpBtn: "license_img", DivShow: "imgdiv", ImgShow: "imgShow" });
  }
  
    /*
    * 展示与不展示
    * 点击切换效果
    */
    $('.btn-group .show input').click(function() {
        var current = $(this).parent();
        var siblings = $(this).parent().siblings();
        current.removeClass("btn-primary-outline").addClass("btn-success");
        siblings.removeClass("btn-success").addClass("btn-primary-outline");
    });

    //城市联动
    $('#province').blur(function() {
        var province_id = $(this).val();
        $('#city').load("__URL__/getCity/province_id/"+province_id);  
    });
    $('#city').blur(function() {
        var city_id = $(this).val();
        $('#area').load("__URL__/getArea/city_id/"+city_id);
        var city_html = $(this).find('option:selected').html();
        var province_html = $('#province').find('option:selected').html();
        $('#address').val(province_html+city_html);
    });
    $('#area').blur(function() {
        var city_html = $('#city').find('option:selected').html();
        var province_html = $('#province').find('option:selected').html();
        var area_html = $(this).find('option:selected').html();
        $('#address').val(province_html+city_html+area_html);
    });
</script>
</body>
</html>
